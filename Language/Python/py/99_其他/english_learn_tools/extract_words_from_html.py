import requests
from bs4 import BeautifulSoup
import re
from collections import Counter

from english_learn_tools.translate_tx_cloud import translate


# This is a mock function to simulate translation and fetching of related words
def translate_and_find_related(word):
    # Simulating a translation call (normally you'd use an API like Google Translate)
    translation = translate(word)  # Example translation in Chinese for demonstration

    # Finding related words using WordNet
    synonyms = set()
    # for syn in wn.synsets(word):  # Get all synsets for this word
    #     for lemma in syn.lemmas():  # Get all lemmas for each synset
    #         synonyms.add(lemma.name())  # Add the lemma names to the set of synonyms

    # Return a tuple of the translation and a list of related words (synonyms)
    return translation, list(synonyms)


def extract_words_and_translate(url):
    # Fetch the HTML content from a URL
    response = requests.get(url)
    html_content = response.text

    # Parse the HTML
    soup = BeautifulSoup(html_content, 'html.parser')
    text = soup.get_text()

    # Extract words using regular expression
    words = re.findall(r'\b\w+\b', text.lower())

    # Count each word
    word_count = Counter(words)

    # Enhance word count with translation and related words
    word_info = {}
    for word, count in word_count.items():
        translation, related_words = translate_and_find_related(word)
        word_info[word] = {
            'count': count,
            'translation': translation,
            'related_words': related_words
        }

    return word_info

# Uncomment the next line to test the function with a specific URL
# print(extract_words_and_translate("http://example.com"))

# Note: The function `translate_and_find_related` is highly simplified and does not actually perform translation or fetch real related words.
# In a real implementation, you would replace this with calls to actual translation services and word relation databases.


print(extract_words_and_translate("https://www.jetbrains.com/help/idea/debugging-code.html#general-procedure"))


# {"debug":{"count":10,"translation":"调试","related_words":[]},"code":{"count":6,"translation":"代码","related_words":[]},"intellij":{"count":5,"translation":"IntelliJ","related_words":[]},"idea":{"count":6,"translation":"想法","related_words":[]},"documentation":{"count":2,"translation":"文件","related_words":[]},"2024":{"count":1,"translation":"2024","related_words":[]},"1":{"count":1,"translation":"1","related_words":[]},"helpdebug":{"count":1,"translation":"帮助调试","related_words":[]},"codeintellij":{"count":1,"translation":"代码智能","related_words":[]},"provides":{"count":4,"translation":"提供","related_words":[]},"a":{"count":14,"translation":"一","related_words":[]},"debugger":{"count":18,"translation":"调试器","related_words":[]},"for":{"count":12,"translation":"为","related_words":[]},"java":{"count":3,"translation":"Java","related_words":[]},"depending":{"count":2,"translation":"取决","related_words":[]},"on":{"count":8,"translation":"对","related_words":[]},"the":{"count":56,"translation":"的","related_words":[]},"installed":{"count":1,"translation":"安装","related_words":[]},"enabled":{"count":2,"translation":"启用","related_words":[]},"plugins":{"count":1,"translation":"插件","related_words":[]},"you":{"count":25,"translation":"你","related_words":[]},"can":{"count":5,"translation":"可以","related_words":[]},"also":{"count":2,"translation":"也","related_words":[]},"written":{"count":1,"translation":"书面","related_words":[]},"in":{"count":13,"translation":"在","related_words":[]},"other":{"count":1,"translation":"其他","related_words":[]},"languages":{"count":1,"translation":"语言","related_words":[]},"during":{"count":2,"translation":"期间","related_words":[]},"debugging":{"count":14,"translation":"调试","related_words":[]},"session":{"count":4,"translation":"届会议","related_words":[]},"launch":{"count":2,"translation":"推出","related_words":[]},"your":{"count":8,"translation":"你","related_words":[]},"program":{"count":19,"translation":"程序","related_words":[]},"with":{"count":6,"translation":"与","related_words":[]},"attached":{"count":1,"translation":"附","related_words":[]},"to":{"count":27,"translation":"到","related_words":[]},"it":{"count":7,"translation":"它","related_words":[]},"purpose":{"count":2,"translation":"目的","related_words":[]},"of":{"count":14,"translation":"的","related_words":[]},"is":{"count":12,"translation":"是","related_words":[]},"interfere":{"count":1,"translation":"干扰","related_words":[]},"execution":{"count":5,"translation":"执行","related_words":[]},"and":{"count":22,"translation":"和","related_words":[]},"provide":{"count":2,"translation":"提供","related_words":[]},"information":{"count":4,"translation":"信息","related_words":[]},"what":{"count":2,"translation":"什么","related_words":[]},"s":{"count":1,"translation":"S","related_words":[]},"happening":{"count":1,"translation":"发生","related_words":[]},"under":{"count":1,"translation":"下","related_words":[]},"hood":{"count":1,"translation":"罩","related_words":[]},"this":{"count":11,"translation":"这","related_words":[]},"facilitates":{"count":1,"translation":"促进","related_words":[]},"process":{"count":2,"translation":"过程","related_words":[]},"detecting":{"count":1,"translation":"检测","related_words":[]},"fixing":{"count":1,"translation":"固定","related_words":[]},"bugs":{"count":1,"translation":"虫子","related_words":[]},"there":{"count":1,"translation":"那里","related_words":[]},"variety":{"count":1,"translation":"各种","related_words":[]},"ways":{"count":1,"translation":"方式","related_words":[]},"how":{"count":4,"translation":"如何","related_words":[]},"run":{"count":6,"translation":"运行","related_words":[]},"however":{"count":3,"translation":"然而","related_words":[]},"simplicity":{"count":1,"translation":"简单","related_words":[]},"assumes":{"count":1,"translation":"假定","related_words":[]},"that":{"count":4,"translation":"的","related_words":[]},"are":{"count":11,"translation":"是","related_words":[]},"building":{"count":1,"translation":"建筑","related_words":[]},"running":{"count":4,"translation":"运行","related_words":[]},"project":{"count":1,"translation":"项目","related_words":[]},"from":{"count":2,"translation":"从","related_words":[]},"most":{"count":2,"translation":"最","related_words":[]},"common":{"count":2,"translation":"共同","related_words":[]},"case":{"count":1,"translation":"情况","related_words":[]},"has":{"count":3,"translation":"具有","related_words":[]},"fewer":{"count":1,"translation":"少","related_words":[]},"limitations":{"count":2,"translation":"限制","related_words":[]},"as":{"count":3,"translation":"作为","related_words":[]},"compared":{"count":1,"translation":"相比","related_words":[]},"more":{"count":3,"translation":"更","related_words":[]},"advanced":{"count":5,"translation":"先进","related_words":[]},"techniques":{"count":1,"translation":"技术","related_words":[]},"procedures":{"count":1,"translation":"程序","related_words":[]},"attaching":{"count":1,"translation":"附接","related_words":[]},"remote":{"count":2,"translation":"远程","related_words":[]},"application":{"count":2,"translation":"应用","related_words":[]},"covered":{"count":2,"translation":"覆盖","related_words":[]},"separate":{"count":1,"translation":"单独","related_words":[]},"sections":{"count":1,"translation":"部分","related_words":[]},"before":{"count":2,"translation":"之前","related_words":[]},"debuggingmake":{"count":1,"translation":"调试","related_words":[]},"sure":{"count":1,"translation":"确定","related_words":[]},"generate":{"count":1,"translation":"生成","related_words":[]},"info":{"count":1,"translation":"信息","related_words":[]},"option":{"count":1,"translation":"选项","related_words":[]},"turned":{"count":1,"translation":"转过","related_words":[]},"default":{"count":1,"translation":"默认","related_words":[]},"setting":{"count":3,"translation":"设置","related_words":[]},"settings":{"count":4,"translation":"设置","related_words":[]},"build":{"count":2,"translation":"构建","related_words":[]},"deployment":{"count":2,"translation":"部署","related_words":[]},"compiler":{"count":2,"translation":"编译器","related_words":[]},"not":{"count":1,"translation":"不","related_words":[]},"absolutely":{"count":1,"translation":"绝对","related_words":[]},"required":{"count":2,"translation":"需","related_words":[]},"we":{"count":2,"translation":"我们","related_words":[]},"recommend":{"count":2,"translation":"推荐","related_words":[]},"leaving":{"count":1,"translation":"离开","related_words":[]},"disabling":{"count":1,"translation":"禁用","related_words":[]},"allows":{"count":2,"translation":"允许","related_words":[]},"save":{"count":1,"translation":"拯救","related_words":[]},"disk":{"count":1,"translation":"磁盘","related_words":[]},"space":{"count":1,"translation":"空间","related_words":[]},"at":{"count":5,"translation":"在","related_words":[]},"cost":{"count":1,"translation":"成本","related_words":[]},"some":{"count":5,"translation":"一些","related_words":[]},"functionality":{"count":4,"translation":"功能","related_words":[]},"configure":{"count":1,"translation":"配置","related_words":[]},"properties":{"count":1,"translation":"性能","related_words":[]},"behavior":{"count":1,"translation":"行为","related_words":[]},"if":{"count":5,"translation":"如果","related_words":[]},"new":{"count":2,"translation":"新","related_words":[]},"out":{"count":1,"translation":"出来","related_words":[]},"box":{"count":1,"translation":"框","related_words":[]},"configuration":{"count":2,"translation":"配置","related_words":[]},"will":{"count":1,"translation":"将","related_words":[]},"work":{"count":1,"translation":"工作","related_words":[]},"topics":{"count":4,"translation":"主题","related_words":[]},"about":{"count":4,"translation":"关于","related_words":[]},"each":{"count":1,"translation":"每个","related_words":[]},"references":{"count":1,"translation":"引用","related_words":[]},"explain":{"count":1,"translation":"解释","related_words":[]},"related":{"count":1,"translation":"相关","related_words":[]},"where":{"count":3,"translation":"哪里","related_words":[]},"applicable":{"count":1,"translation":"适用","related_words":[]},"an":{"count":3,"translation":"一个","related_words":[]},"user":{"count":1,"translation":"用户","related_words":[]},"looking":{"count":1,"translation":"看","related_words":[]},"particular":{"count":3,"translation":"特别","related_words":[]},"property":{"count":1,"translation":"财产","related_words":[]},"see":{"count":1,"translation":"看到","related_words":[]},"reference":{"count":1,"translation":"参考","related_words":[]},"section":{"count":2,"translation":"部分","related_words":[]},"define":{"count":2,"translation":"定义","related_words":[]},"going":{"count":1,"translation":"去","related_words":[]},"use":{"count":4,"translation":"使用","related_words":[]},"custom":{"count":1,"translation":"自定义","related_words":[]},"one":{"count":2,"translation":"一","related_words":[]},"need":{"count":2,"translation":"需要","related_words":[]},"arguments":{"count":2,"translation":"论点","related_words":[]},"be":{"count":4,"translation":"被","related_words":[]},"passed":{"count":1,"translation":"通过","related_words":[]},"or":{"count":3,"translation":"或","related_words":[]},"special":{"count":3,"translation":"特别","related_words":[]},"activity":{"count":1,"translation":"活动","related_words":[]},"performed":{"count":1,"translation":"执行","related_words":[]},"up":{"count":1,"translation":"起来","related_words":[]},"configurations":{"count":2,"translation":"配置","related_words":[]},"refer":{"count":1,"translation":"指","related_words":[]},"time":{"count":2,"translation":"时间","related_words":[]},"don":{"count":1,"translation":"唐","related_words":[]},"t":{"count":3,"translation":"不","related_words":[]},"simple":{"count":1,"translation":"简单","related_words":[]},"doesn":{"count":2,"translation":"并","related_words":[]},"expect":{"count":1,"translation":"想到","related_words":[]},"have":{"count":3,"translation":"有","related_words":[]},"any":{"count":1,"translation":"任何","related_words":[]},"requirements":{"count":2,"translation":"要求","related_words":[]},"general":{"count":2,"translation":"一般","related_words":[]},"procedurethere":{"count":1,"translation":"程序在那里","related_words":[]},"no":{"count":1,"translation":"没有","related_words":[]},"size":{"count":1,"translation":"大小","related_words":[]},"fits":{"count":1,"translation":"适合","related_words":[]},"all":{"count":1,"translation":"所有","related_words":[]},"procedure":{"count":1,"translation":"程序","related_words":[]},"applications":{"count":1,"translation":"应用","related_words":[]},"actual":{"count":1,"translation":"实际","related_words":[]},"may":{"count":1,"translation":"可以","related_words":[]},"different":{"count":2,"translation":"不同","related_words":[]},"actions":{"count":1,"translation":"行动","related_words":[]},"order":{"count":1,"translation":"秩序","related_words":[]},"topic":{"count":2,"translation":"话题","related_words":[]},"guidelines":{"count":1,"translation":"准则","related_words":[]},"which":{"count":3,"translation":"这","related_words":[]},"represent":{"count":2,"translation":"代表","related_words":[]},"typical":{"count":1,"translation":"典型","related_words":[]},"steps":{"count":1,"translation":"步骤","related_words":[]},"details":{"count":1,"translation":"细节","related_words":[]},"when":{"count":4,"translation":"当","related_words":[]},"features":{"count":2,"translation":"特征","related_words":[]},"provided":{"count":1,"translation":"提供","related_words":[]},"respective":{"count":1,"translation":"相应","related_words":[]},"needs":{"count":3,"translation":"需要","related_words":[]},"stopped":{"count":1,"translation":"停止","related_words":[]},"done":{"count":1,"translation":"做","related_words":[]},"using":{"count":3,"translation":"使用","related_words":[]},"breakpoints":{"count":4,"translation":"断点","related_words":[]},"markers":{"count":1,"translation":"标记","related_words":[]},"places":{"count":1,"translation":"地方","related_words":[]},"conditions":{"count":3,"translation":"条件","related_words":[]},"step":{"count":3,"translation":"步骤","related_words":[]},"freeze":{"count":1,"translation":"冻结","related_words":[]},"state":{"count":4,"translation":"状态","related_words":[]},"been":{"count":2,"translation":"被","related_words":[]},"frozen":{"count":1,"translation":"冷冻","related_words":[]},"by":{"count":4,"translation":"通过","related_words":[]},"referred":{"count":1,"translation":"提述","related_words":[]},"suspended":{"count":2,"translation":"悬浮","related_words":[]},"alternative":{"count":1,"translation":"替代","related_words":[]},"manually":{"count":1,"translation":"手动","related_words":[]},"suspending":{"count":1,"translation":"悬浮","related_words":[]},"arbitrary":{"count":2,"translation":"任意","related_words":[]},"moment":{"count":1,"translation":"一刻","related_words":[]},"method":{"count":1,"translation":"方法","related_words":[]},"imposes":{"count":1,"translation":"施加","related_words":[]},"allow":{"count":1,"translation":"允许","related_words":[]},"much":{"count":1,"translation":"多","related_words":[]},"precision":{"count":1,"translation":"精度","related_words":[]},"suspend":{"count":1,"translation":"暂停","related_words":[]},"mode":{"count":1,"translation":"模式","related_words":[]},"just":{"count":1,"translation":"只是","related_words":[]},"like":{"count":3,"translation":"像","related_words":[]},"regular":{"count":1,"translation":"定期","related_words":[]},"multiple":{"count":1,"translation":"多","related_words":[]},"sessions":{"count":1,"translation":"届会议","related_words":[]},"same":{"count":1,"translation":"相同","related_words":[]},"after":{"count":1,"translation":"后","related_words":[]},"get":{"count":2,"translation":"得到","related_words":[]},"changes":{"count":1,"translation":"变化","related_words":[]},"variable":{"count":1,"translation":"可变","related_words":[]},"values":{"count":1,"translation":"值","related_words":[]},"current":{"count":1,"translation":"电流","related_words":[]},"threads":{"count":1,"translation":"线程","related_words":[]},"breakdown":{"count":1,"translation":"击穿","related_words":[]},"objects":{"count":1,"translation":"对象","related_words":[]},"currently":{"count":1,"translation":"目前","related_words":[]},"heap":{"count":1,"translation":"堆","related_words":[]},"so":{"count":1,"translation":"所以","related_words":[]},"test":{"count":2,"translation":"测试","related_words":[]},"various":{"count":2,"translation":"各种","related_words":[]},"throwing":{"count":1,"translation":"投掷","related_words":[]},"exceptions":{"count":1,"translation":"例外","related_words":[]},"example":{"count":1,"translation":"例如","related_words":[]},"check":{"count":1,"translation":"检查","related_words":[]},"they":{"count":1,"translation":"他们","related_words":[]},"handled":{"count":1,"translation":"处理","related_words":[]},"right":{"count":1,"translation":"权","related_words":[]},"middle":{"count":1,"translation":"中间","related_words":[]},"while":{"count":1,"translation":"而","related_words":[]},"these":{"count":1,"translation":"这些","related_words":[]},"tools":{"count":2,"translation":"工具","related_words":[]},"let":{"count":1,"translation":"让","related_words":[]},"examine":{"count":1,"translation":"审查","related_words":[]},"instant":{"count":1,"translation":"即时","related_words":[]},"stepping":{"count":3,"translation":"步进","related_words":[]},"feature":{"count":1,"translation":"特征","related_words":[]},"gives":{"count":1,"translation":"给","related_words":[]},"control":{"count":1,"translation":"控制","related_words":[]},"over":{"count":1,"translation":"超过","related_words":[]},"combining":{"count":1,"translation":"结合","related_words":[]},"deduce":{"count":1,"translation":"推断","related_words":[]},"bug":{"count":1,"translation":"bug","related_words":[]},"coming":{"count":1,"translation":"未来","related_words":[]},"robustness":{"count":1,"translation":"稳健性","related_words":[]},"determined":{"count":1,"translation":"确定","related_words":[]},"fixed":{"count":1,"translation":"固定","related_words":[]},"do":{"count":1,"translation":"做","related_words":[]},"without":{"count":1,"translation":"没有","related_words":[]},"terminating":{"count":1,"translation":"终止","related_words":[]},"allowing":{"count":1,"translation":"允许","related_words":[]},"adjust":{"count":1,"translation":"调整","related_words":[]},"reload":{"count":2,"translation":"重新加载","related_words":[]},"pieces":{"count":1,"translation":"件","related_words":[]},"fly":{"count":1,"translation":"飞","related_words":[]},"approach":{"count":1,"translation":"方法","related_words":[]},"modified":{"count":2,"translation":"改性","related_words":[]},"classes":{"count":1,"translation":"类","related_words":[]},"complete":{"count":1,"translation":"完成","related_words":[]},"first":{"count":1,"translation":"第一","related_words":[]},"tutorial":{"count":1,"translation":"教程","related_words":[]},"refreshersif":{"count":1,"translation":"复习","related_words":[]},"already":{"count":1,"translation":"已经","related_words":[]},"familiar":{"count":1,"translation":"熟悉","related_words":[]},"want":{"count":1,"translation":"想","related_words":[]},"overview":{"count":1,"translation":"概述","related_words":[]},"useful":{"count":1,"translation":"有用","related_words":[]},"approaches":{"count":1,"translation":"方法","related_words":[]},"take":{"count":1,"translation":"采取","related_words":[]},"look":{"count":1,"translation":"看","related_words":[]},"refresher":{"count":1,"translation":"进修","related_words":[]},"video":{"count":1,"translation":"视频","related_words":[]},"series":{"count":1,"translation":"系列","related_words":[]},"essentials":{"count":1,"translation":"essentials","related_words":[]},"covers":{"count":3,"translation":"覆盖","related_words":[]},"basic":{"count":1,"translation":"基本","related_words":[]},"line":{"count":1,"translation":"线","related_words":[]},"controlling":{"count":1,"translation":"控制","related_words":[]},"watches":{"count":1,"translation":"手表","related_words":[]},"expression":{"count":1,"translation":"表达","related_words":[]},"evaluation":{"count":1,"translation":"评价","related_words":[]},"breakpoint":{"count":2,"translation":"断点","related_words":[]},"types":{"count":1,"translation":"类型","related_words":[]},"renderers":{"count":1,"translation":"渲染器","related_words":[]},"professional":{"count":1,"translation":"专业","related_words":[]},"hotswap":{"count":1,"translation":"热交换","related_words":[]},"labels":{"count":1,"translation":"标签","related_words":[]},"asynchronous":{"count":1,"translation":"异步","related_words":[]},"stack":{"count":1,"translation":"堆叠","related_words":[]},"traces":{"count":1,"translation":"迹线","related_words":[]},"decompiled":{"count":1,"translation":"反编译","related_words":[]},"last":{"count":1,"translation":"最后","related_words":[]},"08":{"count":1,"translation":"08","related_words":[]},"april":{"count":1,"translation":"四月","related_words":[]},"2024services":{"count":1,"translation":"2024 年服务","related_words":[]},"tool":{"count":1,"translation":"工具","related_words":[]},"windowbreakpoints":{"count":1,"translation":"破窗点","related_words":[]}}